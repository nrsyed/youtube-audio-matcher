

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>youtube_audio_matcher.audio &mdash; YouTube Audio Matcher  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="youtube_audio_matcher.database" href="youtube_audio_matcher.database.html" />
    <link rel="prev" title="Python API" href="youtube_audio_matcher.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> YouTube Audio Matcher
          

          
          </a>

          
            
            
              <div class="version">
                0.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Setup and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="fingerprinting.html">Audio Fingerprinting</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="youtube_audio_matcher.html">Python API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="youtube_audio_matcher.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">youtube_audio_matcher.audio</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-youtube_audio_matcher.audio">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="youtube_audio_matcher.database.html">youtube_audio_matcher.database</a></li>
<li class="toctree-l3"><a class="reference internal" href="youtube_audio_matcher.download.html">youtube_audio_matcher.download</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="youtube_audio_matcher.html#module-youtube_audio_matcher">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgments</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">YouTube Audio Matcher</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="youtube_audio_matcher.html">Python API</a> &raquo;</li>
        
      <li>youtube_audio_matcher.audio</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/youtube_audio_matcher.audio.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="youtube-audio-matcher-audio">
<h1>youtube_audio_matcher.audio<a class="headerlink" href="#youtube-audio-matcher-audio" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-youtube_audio_matcher.audio">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-youtube_audio_matcher.audio" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="youtube_audio_matcher.audio.align_matches">
<code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">align_matches</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">song_fingerprints</span></em>, <em class="sig-param"><span class="n">db_fingerprints</span></em>, <em class="sig-param"><span class="n">offset_bin_size</span><span class="o">=</span><span class="default_value">0.2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.align_matches" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>song_fingerprints</strong> (<em>List</em><em>[</em><em>dict</em><em>]</em>) – <p>List of fingerprints for the song to
be matched, where each fingerprint is a dict containing the hash
and the time offset in seconds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;hash&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">}</span>
</pre></div>
</div>
</p></li>
<li><p><strong>db_fingerprints</strong> (<em>List</em><em>[</em><em>dict</em><em>]</em>) – <p>List of fingerprints from the database
with matching hashes, where each fingerprint is a dict containing
the database song id, hash, and offset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;song_id&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="s2">&quot;hash&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">}</span>
</pre></div>
</div>
</p></li>
<li><p><strong>offset_bin_size</strong> (<em>float</em>) – Size of offset bin in seconds;
each offset is divided by this value and converted to an
integer to prevent floating point errors and inaccuracies from
affecting the results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>dict|None</dt><dd><p>Dict containing song id, number of matching fingerprints, and
offset of the input song relative to the matched song from the
database if a match was found, else returns <code class="docutils literal notranslate"><span class="pre">None</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;song_id&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="s2">&quot;num_matching_fingerprints&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="s2">&quot;relative_offset&quot;</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>result</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">db_fingerprints</span></code> and <code class="docutils literal notranslate"><span class="pre">song_fingerprints</span></code> are assumed to be
<cite>matches</cite>, i.e., both lists should contain the same set of hashes;
fingerprints with non-matching hashes should be filtered out before
being passed to this function.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.find_peaks_2d">
<code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">find_peaks_2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">filter_connectivity</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">filter_dilation</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">erosion_iterations</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">min_amplitude</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.find_peaks_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Find peaks in a 2D array. See <a class="reference external" href="https://stackoverflow.com/questions/3684484/peak-detection-in-a-2d-array">Peak detection in a 2D array</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – 2D array, e.g., spectrogram.</p></li>
<li><p><strong>filter_connectivity</strong> (<em>int</em>) – neighborhood connectivity of the maximum
filter (<code class="docutils literal notranslate"><span class="pre">1</span></code> produces a diamond, <code class="docutils literal notranslate"><span class="pre">2</span></code> produces a square). See
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.generate_binary_structure.html">scipy.ndimage.generate_binary_structure</a>.</p></li>
<li><p><strong>filter_dilation</strong> (<em>int</em>) – Dilation factor for maximum filter (applied to
the filter generated by <cite>filter_connectivity</cite>). <code class="docutils literal notranslate"><span class="pre">1</span></code> retains
the original filter shape. See <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.iterate_structure.html">scipy.ndimage.iterate_structure</a>.</p></li>
<li><p><strong>erosion_iterations</strong> (<em>int</em>) – Number of times to apply binary erosion.
See <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.binary_erosion.html">scipy.ndimage.binary_erosion</a>.</p></li>
<li><p><strong>min_amplitude</strong> (<em>float</em>) – Peak minimum amplitude (ignore peaks with values
less than <cite>min_amplitude</cite>). If None, all peaks are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>peaks</dt><dd><p>Mask of same shape as <cite>x</cite> where peaks are denoted by True.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.fingerprint_from_file">
<code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">fingerprint_from_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fpath</span></em>, <em class="sig-param"><span class="n">delete</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.fingerprint_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Fingerprint an audio file by reading the file and obtaining the fingerprint
for each audio channel. Wraps <a class="reference internal" href="#youtube_audio_matcher.audio.fingerprint_from_signal" title="youtube_audio_matcher.audio.fingerprint_from_signal"><code class="xref py py-func docutils literal notranslate"><span class="pre">fingerprint_from_signal()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fpath</strong> (<em>str</em>) – Path to audio file.</p></li>
<li><p><strong>delete</strong> (<em>bool</em>) – Delete file after fingerprinting.</p></li>
<li><p><strong>**kwargs</strong> – Keyword args for <a class="reference internal" href="#youtube_audio_matcher.audio.fingerprint_from_signal" title="youtube_audio_matcher.audio.fingerprint_from_signal"><code class="xref py py-func docutils literal notranslate"><span class="pre">fingerprint_from_signal()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(hashes, filehash)</dt><dd><ul class="simple">
<li><p>hashes (List[Tuple[str, float]]): List of tuples where each tuple
is a (hash, absolute_offset) pair. See <a class="reference internal" href="#youtube_audio_matcher.audio.hash_peaks" title="youtube_audio_matcher.audio.hash_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">hash_peaks()</span></code></a>.</p></li>
<li><p>filehash (str): SHA1 hash of the file.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sample rate is obtained from the file. <code class="docutils literal notranslate"><span class="pre">sample_rate</span></code> should not be
passed as part of <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.fingerprint_from_signal">
<code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">fingerprint_from_signal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.fingerprint_from_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Fingerprint an audio signal by obtaining its spectrogram and returning
its hashes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em>) – Array representing the audio signal.</p></li>
<li><p><strong>sample_rate</strong> (<em>int</em>) – Audio signal sample rate (in Hz).</p></li>
<li><p><strong>**kwargs</strong> – Optional keyword args for <a class="reference internal" href="#youtube_audio_matcher.audio.get_spectrogram" title="youtube_audio_matcher.audio.get_spectrogram"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_spectrogram()</span></code></a>,
<a class="reference internal" href="#youtube_audio_matcher.audio.find_peaks_2d" title="youtube_audio_matcher.audio.find_peaks_2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_peaks_2d()</span></code></a>, and <a class="reference internal" href="#youtube_audio_matcher.audio.hash_peaks" title="youtube_audio_matcher.audio.hash_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">hash_peaks()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>hashes</dt><dd><p>List of tuples where each tuple is a (hash, absolute_offset) pair.
See <a class="reference internal" href="#youtube_audio_matcher.audio.hash_peaks" title="youtube_audio_matcher.audio.hash_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">hash_peaks()</span></code></a>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[Tuple[str, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.fingerprint_song">
<em class="property">async </em><code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">fingerprint_song</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">song</span></em>, <em class="sig-param"><span class="n">loop</span></em>, <em class="sig-param"><span class="n">executor</span></em>, <em class="sig-param"><span class="n">out_queue</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.fingerprint_song" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for <a class="reference internal" href="#youtube_audio_matcher.audio.fingerprint_songs" title="youtube_audio_matcher.audio.fingerprint_songs"><code class="xref py py-func docutils literal notranslate"><span class="pre">fingerprint_songs()</span></code></a>. Fingerprints an audio file,
adds the fingerprints (as a list) and file SHA1 hash to the audio file
metadata dict, and pushes it to an output queue (if provided).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>song</strong> (<em>dict</em>) – Dict corresponding to an audio file. Must contain a
<code class="docutils literal notranslate"><span class="pre">path</span></code> key containing the path to the downloaded audio file
(or <code class="docutils literal notranslate"><span class="pre">None</span></code>) if the download wasn’t successful and the file
doesn’t exist.</p></li>
<li><p><strong>loop</strong> (<em>asyncio.BaseEventLoop</em>) – asyncio EventLoop.</p></li>
<li><p><strong>executor</strong> (<em>concurrent.futures.Executor</em>) – <code class="docutils literal notranslate"><span class="pre">concurrent.futures</span></code>
ThreadPoolExecutor or ProcessPoolExecutor in which the audio file
will be processed.</p></li>
<li><p><strong>out_queue</strong> (<em>asyncio.queues.Queue</em>) – Output queue to which video metadata
will be pushed.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments for <a class="reference internal" href="#youtube_audio_matcher.audio.fingerprint_from_file" title="youtube_audio_matcher.audio.fingerprint_from_file"><code class="xref py py-func docutils literal notranslate"><span class="pre">fingerprint_from_file()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>song</dt><dd><p>Input dict with a <code class="docutils literal notranslate"><span class="pre">filehash</span></code> key and a <code class="docutils literal notranslate"><span class="pre">fingerprints</span></code> key
containing a list of fingerprints (returned by
<a class="reference internal" href="#youtube_audio_matcher.audio.fingerprint_from_file" title="youtube_audio_matcher.audio.fingerprint_from_file"><code class="xref py py-func docutils literal notranslate"><span class="pre">fingerprint_from_file()</span></code></a>) added to it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;filehash&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;fingerprints&quot;</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.fingerprint_songs">
<em class="property">async </em><code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">fingerprint_songs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">loop</span></em>, <em class="sig-param"><span class="n">executor</span></em>, <em class="sig-param"><span class="n">in_queue</span></em>, <em class="sig-param"><span class="n">out_queue</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.fingerprint_songs" title="Permalink to this definition">¶</a></dt>
<dd><p>Fingerprint audio files from an input queue and put them in an output
queue for additional processing (e.g., to add them to a database or to
match them against a database). See <a class="reference internal" href="#youtube_audio_matcher.audio.fingerprint_song" title="youtube_audio_matcher.audio.fingerprint_song"><code class="xref py py-func docutils literal notranslate"><span class="pre">fingerprint_song()</span></code></a> for more
information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loop</strong> (<em>asyncio.BaseEventLoop</em>) – <cite>asyncio</cite> EventLoop.</p></li>
<li><p><strong>executor</strong> (<em>concurrent.futures.Executor</em>) – <code class="docutils literal notranslate"><span class="pre">concurrent.futures</span></code>
ProcessPoolExecutor in which the audio file will be processed.</p></li>
<li><p><strong>in_queue</strong> (<em>asyncio.queues.Queue</em>) – Process queue from which audio
metadata is fetched for each song to be processed.</p></li>
<li><p><strong>out_queue</strong> (<em>asyncio.queues.Queue</em>) – Output queue to which audio metadata
will be pushed.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments for <a class="reference internal" href="#youtube_audio_matcher.audio.fingerprint_from_file" title="youtube_audio_matcher.audio.fingerprint_from_file"><code class="xref py py-func docutils literal notranslate"><span class="pre">fingerprint_from_file()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>songs</dt><dd><p>List of dicts representing metadata for the fingerprinted audio
file. See <a class="reference internal" href="#youtube_audio_matcher.audio.fingerprint_song" title="youtube_audio_matcher.audio.fingerprint_song"><code class="xref py py-func docutils literal notranslate"><span class="pre">fingerprint_song()</span></code></a>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.generate_waveform">
<code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">generate_waveform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape</span><span class="o">=</span><span class="default_value">'sine'</span></em>, <em class="sig-param"><span class="n">duration</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">num_samples</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sample_rate</span><span class="o">=</span><span class="default_value">44100</span></em>, <em class="sig-param"><span class="n">frequency</span><span class="o">=</span><span class="default_value">440</span></em>, <em class="sig-param"><span class="n">amplitude</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">duty_cycle</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">out_path</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.generate_waveform" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an int16 waveform signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>str</em>) – {“sine”, “sawtooth”, “square”}
Type of waveform to generate.</p></li>
<li><p><strong>duration</strong> (<em>float</em>) – Duration of audio signal in seconds. If <cite>num_samples</cite>
is provided, <cite>duration</cite> is ignored.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of samples to generate. If None, <cite>duration</cite>
is used to compute the number of samples based on <cite>sample_rate</cite>.</p></li>
<li><p><strong>sample_rate</strong> (<em>int</em>) – Audio signal sample rate in Hz.</p></li>
<li><p><strong>frequency</strong> (<em>float</em>) – Audio signal frequency in Hz.</p></li>
<li><p><strong>amplitude</strong> (<em>float</em>) – Amplitude as a fraction [0, 1] of the total range.
Values are first computed as floats in the range [-1.0, 1.0], then
scaled to the int16 range [-32768, 32767]. This argument
effectively sets the volume of the generated audio signal as a
fraction of maximum possible volume.</p></li>
<li><p><strong>duty_cycle</strong> (<em>float</em>) – Duty cycle in the range [0, 1] for square wave.
See <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.square.html">scipy.signal.square</a>.</p></li>
<li><p><strong>width</strong> (<em>float</em>) – Sawtooth wave width argument in the range [0, 1]. See
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.sawtooth.html">scipy.signal.sawtooth</a>.</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – Filepath to which the audio signal should be written as
a WAV file. If None, file is not saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array representing the audio signal.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.get_spectrogram">
<code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">get_spectrogram</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">sample_rate</span><span class="o">=</span><span class="default_value">44100</span></em>, <em class="sig-param"><span class="n">win_size</span><span class="o">=</span><span class="default_value">4096</span></em>, <em class="sig-param"><span class="n">win_overlap_ratio</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">spectrogram_backend</span><span class="o">=</span><span class="default_value">'scipy'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.get_spectrogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the spectrogram for an audio signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em>) – Array representing the audio signal.</p></li>
<li><p><strong>sample_rate</strong> (<em>int</em>) – Audio sample rate (Hz).</p></li>
<li><p><strong>win_size</strong> (<em>int</em>) – Number of samples per FFT window.</p></li>
<li><p><strong>win_overlap_ratio</strong> (<em>float</em>) – Number of samples to overlap between windows
(as a fraction of window size).</p></li>
<li><p><strong>spectrogram_backend</strong> (<em>str</em>) – {“scipy”, “matplotlib”}
Whether to use the scipy or matplotlib spectrogram functions to
compute the spectrogram. See <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.spectrogram.html">scipy.signal.spectrogram</a> and
<a class="reference external" href="https://matplotlib.org/api/mlab_api.html#matplotlib.mlab.specgram">matplotlib.mlab.specgram</a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(spectrogram, t, freq)</dt><dd><ul class="simple">
<li><p>spectrogram (np.ndarray): 2D array representing the signal
spectrogram (amplitudes are in units of dB).</p></li>
<li><p>t (np.ndarray): 1D array of time bins (in units of seconds)
corresponding to index 1 of <code class="docutils literal notranslate"><span class="pre">spectrogram</span></code>.</p></li>
<li><p>freq (np.ndarray): 1D array of frequency bins (in units of Hz)
corresponding to index 0 of <code class="docutils literal notranslate"><span class="pre">spectrogram</span></code>.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If an invalid <cite>spectrogram_backend</cite> is specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.hash_file">
<code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">hash_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fpath</span></em>, <em class="sig-param"><span class="n">block_size</span><span class="o">=</span><span class="default_value">65536</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.hash_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the SHA1 hash of a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fpath</strong> (<em>str</em>) – Path to file.</p></li>
<li><p><strong>block_size</strong> (<em>int</em>) – Number of bytes to read from the file at a time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>hash</dt><dd><p>SHA1 digest as a hex string.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.hash_peaks">
<code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">hash_peaks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">frequencies</span></em>, <em class="sig-param"><span class="n">fanout</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">min_time_delta</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">max_time_delta</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">hash_length</span><span class="o">=</span><span class="default_value">40</span></em>, <em class="sig-param"><span class="n">time_bin_size</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">freq_bin_size</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.hash_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Hash the peaks of a spectrogram. For reference, see:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://willdrevo.com/fingerprinting-and-audio-recognition-with-python/">Audio Fingerprinting with Python and Numpy</a></p></li>
<li><p><a class="reference external" href="https://medium.com/&#64;treycoopermusic/how-shazam-works-d97135fb4582">How Shazam Works</a></p></li>
<li><p>A. Porter, <a class="reference external" href="https://www.upf.edu/documents/223346843/0/porter2012thesis.pdf">Evaluating musical fingerprinting systems</a>,
Montreal University, 2013.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>times</strong> (<em>np.ndarray</em>) – Time bins of the peaks. Each element in <cite>times</cite>
corresponds to an element in <cite>frequencies</cite>.</p></li>
<li><p><strong>frequencies</strong> (<em>np.ndarray</em>) – Frequency bins of the peaks. Must have the
same number of elements as <cite>times</cite>.</p></li>
<li><p><strong>fanout</strong> (<em>int</em>) – Number of adjacent peaks to consider. For each peak,
hashes will be generated for up to <cite>fanout</cite> peaks within the target
zone defined by <cite>min_time_delta</cite> and <cite>max_time_delta</cite>.</p></li>
<li><p><strong>min_time_delta</strong> (<em>float</em>) – Target zone minimum time offset (only generate
hashes for adjacent peaks that occur at least <cite>min_time_delta</cite>
after a given peak).</p></li>
<li><p><strong>max_time_delta</strong> (<em>float</em>) – Target zone maximum time offset (only generate
hashes for adjacent peaks that occur up to <cite>max_time_delta</cite> after
a given peak).</p></li>
<li><p><strong>hash_length</strong> (<em>int</em>) – Length to which the final hex hash string should be
truncated. A smaller hash length reduces memory usage but increases
likelihood of collisions.</p></li>
<li><p><strong>time_bin_size</strong> (<em>float</em>) – Number of seconds per time bin (used to
convert time deltas from floats to integers before hashing).</p></li>
<li><p><strong>freq_bin_size</strong> (<em>float</em>) – Frequency range per frequency bin (used to
convert frequencies from floats to integers before hashing), in Hz.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>hashes</dt><dd><p>List of tuples where each tuple represents a hash. The first
element of each tuple contains the hash string for the peak pair
and the second element contains a float representing the absolute
offset of the reference peak (first peak) from the beginning of the
audio signal, in seconds.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[Tuple[str, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.plot_fingerprints">
<code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">plot_fingerprints</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">frequencies</span></em>, <em class="sig-param"><span class="n">fanout</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">min_time_delta</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_time_delta</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.plot_fingerprints" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the fingerprints (hash constellation) of a spectrogram’s peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>times</strong> (<em>np.ndarray</em>) – 1D array of the peak times of the audio signal
spectrogram.</p></li>
<li><p><strong>frequencies</strong> (<em>np.ndarray</em>) – 1D array of peak frequencies of the audio
signal spectrogram.</p></li>
<li><p><strong>fanout</strong> (<em>int</em>) – See <a class="reference internal" href="#youtube_audio_matcher.audio.hash_peaks" title="youtube_audio_matcher.audio.hash_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">hash_peaks()</span></code></a>.</p></li>
<li><p><strong>min_time_delta</strong> (<em>float</em>) – See <a class="reference internal" href="#youtube_audio_matcher.audio.hash_peaks" title="youtube_audio_matcher.audio.hash_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">hash_peaks()</span></code></a>.</p></li>
<li><p><strong>max_time_delta</strong> (<em>float</em>) – See <a class="reference internal" href="#youtube_audio_matcher.audio.hash_peaks" title="youtube_audio_matcher.audio.hash_peaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">hash_peaks()</span></code></a>.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – Matplotlib axis handle in which to plot the
fingerprints. If None, a new figure/axis is created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>ax</dt><dd><p>Plot axis handle.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.plot_peaks">
<code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">plot_peaks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">frequencies</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'r'</span></em>, <em class="sig-param"><span class="n">marker</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.plot_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot spectrogram peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>times</strong> (<em>np.ndarray|List</em><em>[</em><em>float</em><em>]</em>) – Array containing time values of peaks.</p></li>
<li><p><strong>frequencies</strong> (<em>np.ndarray|List</em><em>[</em><em>float</em><em>]</em>) – Array containing frequency values
of peaks.</p></li>
<li><p><strong>color</strong> (<em>str</em>) – String or matplotlib color spec representing color of each
peak marker.</p></li>
<li><p><strong>marker</strong> (<em>str</em>) – Matplotlib marker type (see <a class="reference external" href="https://matplotlib.org/api/markers_api.html">matplotlib.markers</a>).</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – Axis handle on which to plot peaks. If None,
a new figure/axis will be created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(ax, pts)</dt><dd><ul class="simple">
<li><p>ax (matplotlib.axes.Axes): Axis handle on which peaks were
plotted.</p></li>
<li><p>pts (matplotlib.collections.PathCollection): Object containing
the points plotted as a scatter plot. See <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.axes.Axes.scatter.html">Axes.scatter</a>.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.plot_spectrogram">
<code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">plot_spectrogram</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spectrogram</span></em>, <em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">frequencies</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.plot_spectrogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the spectrogram of an audio signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spectrogram</strong> (<em>np.ndarray</em>) – 2D array representing the spectrogram
(amplitudes) of the audio signal.</p></li>
<li><p><strong>times</strong> (<em>np.ndarray</em>) – 1D array of the time bins (corresponding to index
1 of <cite>spectrogram</cite>) of the audio signal.</p></li>
<li><p><strong>frequencies</strong> (<em>np.ndarray</em>) – 1D array of the frequency bins (corresponding
to index 0 of <cite>spectrogram</cite>) of the audio signal.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Optional plot title.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – Matplotlib axis handle in which to plot the
spectrogram. If None, a new figure/axis is created.</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure</em>) – Matplotlib figure handle for the figure
containing <cite>ax</cite> (if any). Used for placing colormap scale beside
plot. If <cite>ax</cite> is not provided, a new figure and axis are created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(ax, fig)</dt><dd><ul class="simple">
<li><p>ax (matplotlib.axes.Axes): Plot axis handle.</p></li>
<li><p>fig (matplotlib.figure.Figure): Plot figure handle.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="youtube_audio_matcher.audio.read_file">
<code class="sig-prename descclassname">youtube_audio_matcher.audio.</code><code class="sig-name descname">read_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fpath</span></em><span class="sig-paren">)</span><a class="headerlink" href="#youtube_audio_matcher.audio.read_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an audio file and extract audio information and file SHA1 hash.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fpath</strong> (<em>str</em>) – Path to file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(channel_data, sample_rate, sha1_hash)</dt><dd><ul class="simple">
<li><p>channel_data (List[np.ndarray]): Data for each audio channel.</p></li>
<li><p>sample_rate (int): Audio sample rate (samples per second).</p></li>
<li><p>sha1_hash (str): SHA1 hash of the file.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Does not support 24-bit (use wavio for 24-bit files).</p>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="youtube_audio_matcher.database.html" class="btn btn-neutral float-right" title="youtube_audio_matcher.database" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="youtube_audio_matcher.html" class="btn btn-neutral float-left" title="Python API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Najam R Syed

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>